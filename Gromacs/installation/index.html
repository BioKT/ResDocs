<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

        <title>Installation - David De Sancho Toolbox</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">David De Sancho Toolbox</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../about">About</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Gromacs <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li class="active">
                                <a href=".">Installation</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">VMD <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../VMD/scripts">Scripts</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                </ul>
            

            
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li >
                    <a rel="next" href="../../about">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../../VMD/scripts">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
            </ul>
            
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#gromacs-installation-in-mac-os-x">Gromacs installation in Mac OS X</a></li>
        
            <li><a href="#building-gromacs-4-using-make">Building Gromacs 4.* using MAKE</a></li>
        
            <li><a href="#building-gromacs-5-using-cmake">Building Gromacs 5.* using CMAKE</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="gromacs-installation-in-mac-os-x">Gromacs installation in Mac OS X</h1>
<h2 id="building-gromacs-4-using-make">Building Gromacs 4.* using MAKE</h2>
<p>One of the prerequisites for the installation are the fftw libraries for
doing Fourier transforms. Setting these up correctly seems to be limiting, 
as in the <code>configure</code> step Gromacs struggled to find the Macports libraries.
So first of all, download 
<a href="ftp://ftp.gromacs.org/pub/prerequisite_software/fftw-3.0.1.tar.gz">fftw-3.0.1.tar.gz</a> 
on your computer. Then you can simply install as</p>
<pre><code>./configure --enable-float --enable-threads
make
sudo make install
</code></pre>

<p>Then you can download the source code and proceed to install Gromacs in the usual 
way</p>
<pre><code>./configure --prefix=/usr/local/gromacs/4.0.5 --enable-threads --enable-float
make
make install
</code></pre>

<p>I still need to work out how to make this run in parallel on a Mac.</p>
<h2 id="building-gromacs-5-using-cmake">Building Gromacs 5.* using CMAKE</h2>
<p>(These instructions were borrowed from 
<a href="http://philipwfowler.me/">Phillip W Fowler´s</a> blog).</p>
<p>Prerequisites for the installation are the gcc compilers available at MacPorts.
This requires you to first install Xcode.</p>
<p>Then the most important thing is to download the source code from the Gromacs 
website and unpack the software.</p>
<pre><code>tar xvf gromacs-5.0.4.tar.gz
cd gromacs-5.0.4
mkdir build
</code></pre>

<p>Then we start with the interestign stuff. In the last few versions Gromacs
has made a transition towards using cmake instead of make. Cmake is readily 
available for Mac OS X, so no problem with this. Then you must run the following
in the command line:</p>
<pre><code>cmake .. -DGMX_BUILD_OWN_FFTW=ON -DCMAKE_INSTALL_PREFIX='/usr/local/gromacs/5.0.4/'
make
sudo make install
</code></pre>

<p>This will install the program in <code>/usr/local/gromacs/5.0.4</code>, and editing your <code>.bashrc</code>
file you will be able to choose the version of Gromacs that is running.</p>
<p>Adding MPI support on a Mac is trickier. This appears mainly to be because the gcc 
compilers from MacPorts  do not appear to support OpenMPI. Here is a workaround </p>
<pre><code>sudo port install openmpi
</code></pre>

<p>Now we need a compiler that supports OpenMPI</p>
<pre><code>sudo port install openmpi-devel-gcc49
</code></pre>

<p>Finally, we can follow the steps above but now we need a more complex cmake instruction</p>
<pre><code>cmake .. -DGMX_BUILD_OWN_FFTW=ON
    -DGMX_BUILD_MDRUN_ONLY=on
    -DCMAKE_INSTALL_PREFIX=/usr/local/gromacs/5.0.2
    -DGMX_MPI=ON -DCMAKE_C_COMPILER=mpicc-openmpi-devel-gcc49
    -DCMAKE_CXX_COMPILER=mpicxx-openmpi-devel-gcc49
    -DGMX_SIMD=SSE4.1
</code></pre>

<p>This is only going to build an MPI version of <code>mdrun</code>, as the other Gromacs programs do not
run in parallel. We have to tell cmake what all the new fancy compilers are called and, 
unfortunately, these don’t support AVX SIMD instructions so we have to fall back to SSE4.1. 
Experience suggests this doesn’t impact performance as much as you might think. </p>
</div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/prettify-1.0.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>